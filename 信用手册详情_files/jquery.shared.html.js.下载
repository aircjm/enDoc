js.GetLinkButton=function(d,b,c){if(!d){return $("a[action]",b)}var a=js._buttons[d];if(c||!a){a=$("a[action="+d+"]",b);js._buttons[d]=a}return a};js.Web.GetClipboard=function(e,c,f,j){var b=js.Browser?js.Browser.isIE:false;if(b){return(window.clipboardData.getData("text"))}else{if(f){var i=document.createElement("div");$(i).css("display","none").css("position","absolute");$(i).attr("tname",$(e).attr("name")).attr("gname","pastetext");$(i).append('<textarea name="pastearea" style="width:200px;height:100px"></textarea>');document.body.appendChild(i)}else{if(!j){var d=js.Web.GetZeroClipboard(e);if(d){return d.getText(c)}return}}if(j){if(!b){var a=$('div[tname="'+$(e).attr("name")+'"]');var h=($(window).width()-200)/2,g=($(window).height()-100)/2;$(a).css("display","block").css("top",g).css("left",h);$(a).find("textarea").val("");$(a).find("textarea").focus()}else{return(window.clipboardData.getData("text"))}}}return null};js.Web.GetZeroClipboard=function(a){if(!js.Web._ZeroClipboard){js.Web._ZeroClipboard={}}var e=$(a).attr("name");if(!js.Web._ZeroClipboard[e]&&window.ZeroClipboard){ZeroClipboard.setMoviePath(js.Web.GenerateAbsoluteUrl("/Scripts/jquery.clipboard.swf",false));var d=js.CreateNewId();var c=null;if(a){c=a.target?a.target:a}else{c=document.createElement("div");c.id=d;document.body.appendChild(c)}var b=document.createElement("div");$(b).css("display","none").css("position","absolute");$(b).attr("tname",e).attr("gname","pastetext");$(b).append('<textarea name="pastearea" style="width:200px;height:100px"></textarea>');document.body.appendChild(b);js.Web._ZeroClipboard[e]=new ZeroClipboard.Client(c);js.Web._ZeroClipboard[e].setHandCursor(true);js.Web._ZeroClipboard[e].id=d;js.Web._ZeroClipboard[e].el=c;js.Web._ZeroClipboard[e].pasetArea=b;js.Web._ZeroClipboard[e].addEventListener("load",function(f){});js.Web._ZeroClipboard[e].addEventListener("mousedown",function(f){try{f.domElement.onclick.call(f.domElement)}catch(g){js.Web.ShowMsg("错误: "+g)}});js.Web._ZeroClipboard[e].addEventListener("complete",function(f){var g=$(f.domElement).attr("name");switch(g){case"copy":case"copy2":if(js.Web.LastClipboardText){js.Web.ShowMsg("已经复制成功!")}else{js.Web.ShowMsg("您没有复制任何数据!")}break;case"paste":case"paste2":break;default:break}})}return js.Web._ZeroClipboard[e]};js.Web.ClearHtmlElements=function(a,b){var c=a;if(b){c.find("input[type=hidden]").val("")}c.find("input[type=text], textarea").val("");c.find("input[type=radio]").attr({checked:false});c.find("input[type=checkbox]").attr({checked:false});c.find("select option").attr("selected","");c.find("select").attr("value","");c.find("select").val("")};js.Web.GetHtmlElements=function(a,e){var c=a;if(!js.IsJQuery(a)){c=$(a)}e=e||{};e.Fields=[];e.Buttons=[];b=c.find("input[type=checkbox]");var d={};b.each(function(g,h){var i=$(h);if(h.checked){var f=js.Controls.GetName(i);e[f]=i;e.Fields.push(i);d[f]=i}});var b=c.find("input, textarea, select,radio");b.each(function(h,i){var j=$(i);var g=js.Controls.GetName(j);if(d[g]&&j.attr("type")=="hidden"){return}var f=null;js.Web.AttachCommonFieldFunctions(j);e[g]=j;e.Fields.push(j)});return e};js.Web.RoundTableTrText=function(a,b){var c=a;c.find("td").each(function(){RoundTableTdText($(this),b)})};js.Web.RoundTableTdText=function(a,b){var d=a;var e=a.text().replace(/(^\s*)|(\s*$)/g,"").replace(" ","");if(e!=null&&e!=""&&!isNaN(e)){var c=parseFloat(e);a.text(c.toFixed(b))}};js.Web.ClearChildren=function(b){for(var a=b.childNodes.length-1;a>=0;a--){b.removeChild(b.childNodes[a])}};js.Web.SetTableInnerHTML=function(j,f,a){var b=true;if(b){var h=window.document.createElement("div");if(a){h.innerHTML="<table><tbody>"+f+"</tbody></table>"}else{h.innerHTML="<table>"+f+"</table>"}if(j.tBodies.length<=0){var e=window.document.createElement("tbody");j.appendChild(e)}if(a){j.replaceChild(h.childNodes[0].tBodies[0],j.tBodies[0])}else{js.Web.ClearChildren(j);var c=h.childNodes[0];for(var d=c.childNodes.length-1;d>=0;d--){j.appendChild(c.childNodes[d])}}}else{var g=false;for(var d=0;d<j.childNodes.length;d++){if(j.childNodes[d].nodeName.toLower()=="tbody"){j.childNodes[d].innerHTML=f;return}}j.innerHTML=f}};js.Web.AttachCommonFieldFunctions=function(a){if(js.IsString(a)){a=$(a)}else{if(!js.IsJQuery(a)&&js.IsObject(a)){a=$(a)}}if(!js.IsJQuery(a)){return a}a.getName=null;a.getValue=null;a.setValue=null;a.setText=null;return a};js.Web.InitAjaxPage=function(e){var d=e.match(/<script.*?src ?= ?"([^"]+)"/ig);if(d==null){return}var c={},a,g;for(var b=0;b<d.length;b++){g=d[b].match(/src ?= ?"([^"]+)"/i)[1];c[g]=g}for(var f in c){$.getScript(f,function(h,j,i){})}};js.Web.SerializeForm=function(b){if(!b){return""}var f=b.elements,g={};if(!f){f=[];$("input",b).each(function(i,j){f.push(j)});$("SELECT",b).each(function(i,j){f.push(j)});$("TEXTAREA",b).each(function(i,j){f.push(j)})}var o=f.length;function q(j,s){var i=g[j];if(i===undefined){g[j]=s}else{if(js.IsArray(i)){i.push(s)}else{g[j]=[i,s]}}}for(var k=0;k<o;k++){var l=f[k];var a=l.name;if(!a||!a.length||l.disabled){continue}var d=l.tagName.toUpperCase();if(d==="INPUT"){var r=l;var p=r.type;if((p==="text")||(p==="password")||(p==="hidden")||(((p==="checkbox")||(p==="radio"))&&l.checked)){q(a,r.value)}}else{if(d==="SELECT"){var n=l;var m=n.options.length;for(var h=0;h<m;h++){var e=n.options[h];if(e.selected){q(a,e.value)}}}else{if(d==="TEXTAREA"){q(a,l.value)}}}}var c=b._additionalInput;if(c){return EncodeUrl(g,null,null,null,null,true)+"&"+c}return g};js.Web.AjaxRequest=function(sender,url,params,callback,success,failure,isPost,showDefaultMsg,hideResponseMsg,timeout){if(!url||url=="#"){return js.Sys.ShowDebugAlert("url为空，请检查你的代码是否正确",true)}if(js.IsNull(showDefaultMsg)||showDefaultMsg===true){showDefaultMsg="操作执行中，请等待..."}params=params||{};var progress=null,addRandom=params._addRandom;delete params._addRandom;if(showDefaultMsg&&$.messager){$.messager.progress({title:showDefaultMsg,interval:1000})}else{if(showDefaultMsg&&window.Ext){progress=Ext.MessageBox.progress("提示",showDefaultMsg,"")}}try{var senderControl=null;if(sender&&!sender.el&&!sender.render){try{senderControl=$(sender)}catch(ex){senderControl=null}}if(senderControl&&senderControl.hide){senderControl.hide()}var type="GET";if(isPost==true){type="POST"}else{if(isPost){type=isPost}}js.Init.RemoveLocalProperties(params,true);if(typeof(params)=="object"){params=js.Web.AppendAjaxHeader(params,url,addRandom)}else{url=js.Web.AppendUrlParams(url,js.Web.AppendAjaxHeader(null,url,addRandom))}function doAction(data,rsuccess){if(data.url){js.Web.OpenWindow(sender,data.url,data.target||"_self",null,null,null);return true}else{if(rsuccess&&callback&&typeof(callback)=="string"){window.open(callback,"_self")}}}if(timeout&&timeout<30){timeout=timeout*1000}jQuery.ajax({url:url,context:sender||this,success:function(data){if(showDefaultMsg&&$.messager){$.messager.progress("close")}else{if(showDefaultMsg&&progress){progress.hide()}}try{if(typeof(data)=="string"){try{data=eval("("+data+")")}catch(ex){}}var rsuccess=data&&data.success;if(rsuccess&&success){success(sender,data,params)}else{if(!rsuccess&&failure){failure(sender,data,params)}}if(callback&&typeof(callback)=="function"){try{callback(rsuccess,data,params)}catch(ex){alert(ex)}}if(data&&data.msg&&!hideResponseMsg){js.Web.ShowMsg(data.msg,"提示",null,function(){doAction(data,rsuccess)},0)}else{if(showDefaultMsg&&!hideResponseMsg){js.Web.ShowMsg(rsuccess?js.UI.UIText("Info_Action_Success"):js.UI.UIText("Info_Action_Failure"),null,null,function(){doAction(data,rsuccess)},0)}}}catch(e){js.Web.ShowAlertMsg(e)}finally{if(senderControl!=null){senderControl.show()}}},failure:function(data){if(showDefaultMsg&&$.messager){$.messager.progress("close")}else{if(showDefaultMsg&&progress){progress.hide()}}try{if(failure){failure(sender,data,params)}if(callback){try{callback(false,data,params)}catch(ex){alert(ex)}}if(data&&data.msg&&!hideResponseMsg){js.Web.ShowMsg(data.msg,"提示",null,function(){doAction(data,false)},0)}else{if(showDefaultMsg&&!hideResponseMsg){js.Web.ShowMsg(js.UI.UIText("Info_Action_Failure"),"失败",null,function(){doAction(data,false)},0)}}}catch(e){js.Web.ShowAlertMsg(e)}finally{if(senderControl!=null){senderControl.show()}}},error:function(handle,type,error){try{if(showDefaultMsg&&$.messager){$.messager.progress("close")}else{if(showDefaultMsg&&progress){progress.hide()}}error=js.Web.GetFriendlyErrorMessage(error,type);if(!hideResponseMsg){js.Web.ShowMsg("不好意思失败了, 附加消息为: "+error)}if(callback&&typeof(callback)=="function"){try{callback(false,{success:false,msg:error},params)}catch(ex){alert(ex)}}}catch(e){js.Web.ShowAlertMsg(e)}finally{if(senderControl!=null){senderControl.show()}}},data:params,type:type,timeout:timeout})}catch(ex){if(showDefaultMsg&&$.messager){$.messager.progress("close")}js.Web.ShowMsg("发生异常错误，错误信息: "+ex)}};js.Web.AjaxLinkClicked=function(e,c,d,i,h,g,b){var j=$(e),a=j.attr("href");c=js.Web.IsBlankLink(e,a)?c:a;e=e||this;if(g&&typeof(g)=="function"&&g(e,c,d,i,h)===false){return}if(g&&typeof(g)=="string"){js.Web.ShowMsg(g,"提示",null,function(k){if(k){f()}},2);return false}function f(){var l=null;var k=null;try{if(i){l=js.Web.FindForm(e);if(!l){return}k=l.action;c=c||k;js.Web.SubmitForm(l,c,d,h,null,true);return false}js.Web.AjaxRequest(e,c,d,h,null,null,i,true)}finally{if(l&&k){l.action=k}}js.StopEvent(b||window.event);return false}return f()};js.Web.LinkClicked=function(h,c,e,i,k,l,m,g,f,b){b=b||window.event;if(i){var d=js.Web.FindForm(h);if(d){d.reset();js.Web.ClearHtmlElements($(d),true)}return false}if(f){return js.Web.AjaxLinkClicked(h,c,g,e,m,l)}var n=$(h),a=n.attr("href");c=js.Web.IsBlankLink(h,a)?c:a;h=h||this;if(l&&typeof(l)=="function"&&l(h,c,g,e,m)===false){return false}else{if(l&&typeof(l)=="string"){js.Web.ShowMsg(l,"提示",null,function(o){if(o){j()}},2);return false}}function j(){if(l===false){return false}if(l&&!l(h,e,i,k)){return false}if(!e){var p=k?js.Web.FindWindow(window,null):window;if(!c){return true}if(g){c=js.Web.AppendUrlParams(c,g)}p.open(c,h.target||"_self",null);return false}var q=js.Web.FindForm(h);if(!q){return false}var o=q.action;try{c=js.Web._ChangePostUrl(c||o);js.Web.SubmitForm(q,c,g,m,null,true)}finally{q.action=o}return false}return j()};js.Web.RegisterViewPage=function(a,b){if(window.CollectGarbage){CollectGarbage()}$(function(){try{window.ViewPage=new a(b);if(js.Controls&&js.Controls.ComponentContainer){for(var e in js.Controls.ComponentContainer){var c=js.Controls.ComponentContainer[e];if(c.loadFirstTime&&c.methods&&c.methods.read){c.methods.read()}}}}catch(d){js.Web.ShowAlertMsg("加载页面失败，附加信息: "+d.message+", 堆栈: "+d.stack)}})};js.Web.SubmitForm=function(form,url,params,callback,options,showDefaultMsg,confirmText,ingoreValiduate){var jform=form;if(!js.IsJQuery(form)){jform=$(form)}form=jform[0];options=options||{};if(!ingoreValiduate&&form.onValiduate&&!form.onValiduate()){return false}if(!ingoreValiduate&&!js.Controls.ValidateBox(jform)){return false}function doAction(){if($.messager){$.messager.progress({title:"操作执行中，请等待...",interval:1000})}try{var id=form.target||js.GenerateUnquieId(),oframe=document.getElementById(id),frame=document.createElement("iframe"),jframe=$(frame),hiddens=[],encoding="multipart/form-data",buf={target:form.target,method:form.method,encoding:form.encoding,enctype:form.enctype,action:form.action},addField=function(name,value){hiddenItem=document.createElement("input");var jhiddenItem=$(hiddenItem).attr({type:"hidden",value:value,name:name});form.appendChild(hiddenItem);hiddens.push(hiddenItem)},hiddenItem,obj,value,name,vLen,v,hLen,h;if(oframe){frame=oframe;jframe=$(oframe);jframe.addClass("eui-invisbile")}else{jframe.attr({id:id,name:id,src:js.SSL_SECURE_URL});jframe.addClass("eui-invisbile");document.body.appendChild(frame);if(document.frames){document.frames[id].name=id}}var nUrl=url||buf.action;if(!nUrl||nUrl=="#"){return js.Sys.ShowDebugAlert("url为空，请检查你的代码是否正确",true)}params=js.Apply({rtype:"text","X-Requested-With":"XMLHttpRequest"},params);nUrl=js.Web.AppendUrlParams(nUrl,params,false);jform.attr({target:id,method:"POST",enctype:encoding,encoding:encoding,action:nUrl});form.setAttribute("target",id);try{jframe.on("load",function(event){if($.messager){$.messager.progress("close")}var me=this,responseText,response,success,doc,contentNode,tcallback;try{doc=frame.contentWindow.document||frame.contentDocument||window.frames[frame.id].document;if(doc){if(doc.body){if((contentNode=doc.body.firstChild)&&/pre/i.test(contentNode.tagName)){responseText=contentNode.textContent||contentNode.innerText}else{if((contentNode=doc.getElementsByTagName("textarea")[0])){responseText=contentNode.value}else{responseText=doc.body.textContent||doc.body.innerText}}}tcallback=options.success;success=true}}catch(e){responseText='{success:false,msg:"'+(e.message||e.description).trim()+'"}';tcallback=options.failure;success=false}try{response=eval("("+responseText+")")}catch(ex){success=false;response={success:false,msg:responseText}}if(!response){response={}}if(!js.IsNull(response.success)){success=response.success}if(tcallback){tcallback(success,response)}if(callback&&typeof(callback)=="function"){callback(success,response)}if(response.msg){js.Web.ShowMsg(response.msg,"提示",null,doAction,0)}else{if(showDefaultMsg){js.Web.ShowMsg(success?js.UI.UIText("Info_Action_Success"):js.UI.UIText("Info_Action_Failure"),"提示",null,doAction,0)}}function doAction(){if(response.url){js.Web.OpenWindow(this,response.url,response.target||"_self");return true}else{if(success&&callback&&typeof(callback)=="string"){js.Web.OpenWindow(this,callback,"_self",null,null,null)}}window.setTimeout(function(){jframe.remove()},100)}});form.submit()}catch(e){if(callback){callback(false,{success:false,msg:e})}}finally{jform.attr(buf);hLen=hiddens.length;for(h=0;h<hLen;h++){$(hiddens[h]).remove()}}}catch(ex){if($.messager){$.messager.progress("close")}js.Web.ShowMsg("发生异常错误，错误信息: "+ex)}}if(confirmText){js.Web.ShowMsg(confirmText,"提示",null,function(success){if(success){doAction()}},2);return}return doAction()};js.Web.PrintPanel=function(j,f,a,d,h){if(j){window.focus();window.print();return}if(!d){d={}}if(!h){h={}}var i=js.GenerateUnquieId();function k(o,q,n){if(!q){q={}}var v=o;var t=window.open("#",i,null,null);if(n.title){q.Page_Title=n.title}js.CopyObject(n,q,true);var m;var u;for(var r in q){m=q[r];if(typeof m=="function"){m=m()}u="{"+r+"}";while(v.match(u)){v=v.replace(u,m)}}try{$(t.document).html(v)}catch(p){}if(!confirm('已经在另外的窗口中准备好打印页面，请点击"确定"确认转到该页面，点击"取消"继续操作!')){return}t.focus();t.print()}if(a==null){var l=document.documentElement.outerHTML;var g=(document.getElementById("main")||document.body).innerHTML;var c=document.getElementById(f);if(c){f=c.innerHTML}l=l.replace(g,f);var b=document.getElementById("footer");if(b){b=b.outerHTML;l=l.replace(b,"")}k(l,null,d)}else{var e=js.Web.GenerateUrl("Home","GetPrintTemplate",a,{TemplateId:a});$.ajax(e).done(function(m){k(m,f,d)}).fail(function(){js.Web.ShowMsg("获取打印模板失败!","失败",null,null,0)})}};js.Init.RestoreJQueryFunctions=function(){js.Init.IsJQueryFunctionStored=true;for(var a in js.Init._JQueryFunctions){jQuery.fn["jQuery_"+a]=js.Init._JQueryFunctions[a]}};js.Init.InitEditFields=function(isInitPage,selector){if(!selector&&!js.Sys.InitEditFields){return}var tables=null;if(selector&&js.IsJQuery(selector)){tables=selector.find(" .eui-table")}else{tables=$((selector||"")+" .eui-table")}function calcuateTableCells(field,parentNode){field=field||this;var table=$(field),tableDataOptions=table.data("dataOptions")||table.attr("data-options")||"_end:null",jparentNode=$(parentNode),pdialog=table.parents(".eui-dialog"),pWidth=jparentNode.innerWidth(),pHeight=jparentNode.innerHeight(),cols=table.find("thead th.eui-table-head-cell"),rows=table.find("tbody tr");if(tableDataOptions&&js.IsString(tableDataOptions)){tableDataOptions=eval("({"+tableDataOptions+"})");table.data("dataOptions",tableDataOptions)}var tableWidth=table.width(),colWidths=[],colOptionArray=[],sumPercent=0,sumPixel=0,totalPercentWidth=0,dataOptions=null,totalSumPercent=1;if(tableWidth>pWidth&&pWidth>60){tableWidth=pWidth}if(pdialog.length>0){tableWidth-=20}js.Each(cols,function(field,index){var tthis=$(field),tdataOptions=tthis.data("dataOptions")||tthis.attr("data-options")||"_end:null";if(tdataOptions&&js.IsString(tdataOptions)){var dataOptions=eval("({"+tdataOptions+"})");tthis.data("dataOptions",dataOptions)}else{dataOptions=tdataOptions}if(dataOptions.width>0&&dataOptions.isPercent){sumPercent+=dataOptions.width}else{if(dataOptions.width>0&&dataOptions.isPercent==false){sumPixel+=dataOptions.width}}});totalPercentWidth=tableWidth-sumPixel-2;if(totalPercentWidth<0&&sumPixel>0){totalPercentWidth=0;totalSumPercent=tableWidth/sumPixel}js.Each(cols,function(field,index){var tthis=$(field);dataOptions=tthis.data("dataOptions");if(!dataOptions){return}if(dataOptions.width>0){if(totalPercentWidth>0&&dataOptions.isPercent){dataOptions.realWidth=totalPercentWidth*dataOptions.width/sumPercent}else{if(dataOptions.isPercent==false){dataOptions.realWidth=dataOptions.width*totalSumPercent}else{dataOptions.realWidth=0}}}else{dataOptions.realWidth=0}if(!dataOptions.DefaultLabelWidth){dataOptions.DefaultLabelWidth=tableDataOptions.DefaultLabelWidth}if(!dataOptions.PaddingWidth){dataOptions.PaddingWidth=tableDataOptions.PaddingWidth}dataOptions.realWidth-=2;tthis.width(dataOptions.realWidth);colWidths.push(dataOptions.realWidth);colOptionArray.push(dataOptions)});js.Each(rows,function(trow,index){var row=$(trow),cells=row.find("td"),colIndex=0;js.Each(cells,function(field,index){var tthis=$(field),tdataOptions=tthis.data("dataOptions")||tthis.attr("data-options")||"_end:null",comCell=tthis.find(".eui-cell-combine"),colSpan=Number(tthis.attr("colSpan")),rowSpan=Number(tthis.attr("rowSpan")),cellWidth=0;if(tdataOptions&&js.IsString(tdataOptions)){dataOptions=eval("({"+(tdataOptions||"")+"})");dataOptions.colSpan=Number(colSpan||1);dataOptions.rowSpan=Number(rowSpan||1);dataOptions.colIndex=Number(colIndex);dataOptions.DefaultLabelWidth=dataOptions.DefaultLabelWidth||colOptionArray[colIndex].DefaultLabelWidth||tableDataOptions.DefaultLabelWidth||90;dataOptions.PaddingWidth=dataOptions.PaddingWidth||colOptionArray[colIndex].PaddingWidth||tableDataOptions.PaddingWidth||0;tthis.data("dataOptions",dataOptions)}else{dataOptions=tdataOptions}for(var ci=0;ci<dataOptions.colSpan;ci++){cellWidth+=colWidths[ci+colIndex]}colIndex+=Number(dataOptions.colSpan);dataOptions.realWidth=Number(cellWidth);cellWidth=dataOptions.realWidth;tthis.width(cellWidth);if(comCell.length>0){var labelSpan=comCell.find(".eui-table-cell-label"),labelWidth=labelSpan.width(),alabelWidth=labelSpan.attr("width");if(labelWidth<50||!alabelWidth){labelWidth=dataOptions.DefaultLabelWidth}labelSpan.width(labelWidth);var fieldSpan=comCell.find(".eui-table-cell-field"),width=cellWidth-labelWidth-25-dataOptions.PaddingWidth;if(width<=0){width=cellWidth}if(fieldSpan.length>0){fieldSpan.width(width);var firstVisibleChild=null,child=null,firstChild=null,hasTip=false;for(var i=0;i<fieldSpan[0].children.length;i++){child=fieldSpan[0].children[i];if(!firstChild){firstChild=$(child)}if($(child).width()>5&&$(child).is(":visible")){firstVisibleChild=$(child);break}}hasTip=fieldSpan.find(".eui-tooltip");if(hasTip){width-=20}if(firstChild){var combo=firstChild.data("combobox");if(combo){firstChild.combobox("resize",width-2)}else{if(firstVisibleChild){firstVisibleChild.width(width-7)}}}}}})})}tables.each(function(index,field){calcuateTableCells(field,field.parentNode)})};js.Init.InitPreInitControls=function(){var controls=js.PreInitControls;function findControls(elements,container,allContainer,func){var name;for(var i=0;i<elements.length;i++){name=elements[i].name||elements[i].id;if(!name){name=js.CreateNewId();elements[i].id=name}elements[i].name=name;container[name]=elements[i];if(func){func(elements[i],name,container)}allContainer.push(elements[i])}}findControls($("a"),controls.Buttons,controls.Buttons._All);findControls($("form"),controls.Forms,controls.Forms._All,function(ele,name,container){controls.TextBoxs[name]={};findControls($(" input[type=text]",ele),controls.TextBoxs[name],controls.TextBoxs._All)});if(js.Controls&&js.Controls._initButtonMethods){js.Controls._initButtonMethods()}var dInputs=$("input[data-options]");for(var i=0;i<dInputs.length;i++){var dInput=$(dInputs[i]);var odata=eval("({"+dInput.attr("data-options")+"})");dInput.data("data-options",odata);dInput.keydown(js.Keys.GeneralKeyDown)}};js.Init.RenderTabs=function(){var b=$(".eui-tabs");var a={ajaxOptions:{error:function(f,c,e,d){$(d.hash).html("不能正常导入Tab，请与管理者联系！")}},onSelect:{}};if(js.Init.IsJQueryFunctionStored){b.jQuery_tabs(a)}else{if(b.tabs){b.tabs(a)}}};js.Init.PageLoaded=function(){js.Init._PageSized(true);js.Init.CloseLoading();var a=function(b){if(js.Init._PageSizeHandler){window.clearTimeout(js.Init._PageSizeHandler)}js.Init._PageSizeHandler=window.setTimeout(js.Init._PageSized,500)};if(window.attachEvent){window.attachEvent("onresize",a)}else{window.onresize=a}};js.Init.InitValidator=function(){if(!$.validator){return}if($.validator.messages){$.validator.messages.required="请输入内容！";$.validator.messages.number="请输入有效数字！";$.validator.messages.email="请输入有效的email！"}$.validator.addMethod("isInt",function(b,a){if(this.optional(a)){return true}return !isNaN(b)},"请正确填写您的值");$('input[valueType="int"]').validate(function(){var a=this;if(isNaN(a.value)){return false}return true});$("form").validate()};js.Init.InitClientAlertOptions=function(l){if(!l){return}var i=l.type,f=l.isWaiting,c=l.interval||20,j=l.title||"提示",d=l.msg,e=l.yesUrl,h=l.noUrl,k=l.waitingUrl;if(f){if($.messager.progress){$.messager.progress({title:j,msg:d,interval:1000})}var g=null;function b(m){if($.messager.progress){$.messager.progress("close");$.messager.progress({title:j,msg:m.msg||d,interval:1000})}if(g){clearTimeout(g)}g=setTimeout(a,c*1000)}function a(){if(k){jQuery.ajax({url:k,success:function(m){if(m.success){if(e){js.Web.OpenWindow(this,e,null,null,null,null)}if($.messager.progress){$.messager.progress("close")}}else{b(m)}},failure:b,error:b})}else{if($.messager.progress){$.messager.progress("close")}}}if(k){a()}else{g=setTimeout(a,c*1000)}}else{js.Web.ShowMsg(d,j,null,function(m){if((m||i==0)&&e){js.Web.OpenWindow(this,e,null,null,null,null)}else{if(!m&&h){js.Web.OpenWindow(this,h,null,null,null,null)}}},i)}};js.Init.InitTooltip=function(a){$("[tooltipId]").each(function(b,d){var c=$(d),e=$('<span class="ui-icon ui-icon-info" style="float:left;"></span>');e.appendTo(c)});$("[tooltipId]").click(function(){var b=$(this),d=b.attr("tooltipId");function e(g,f){$("#alert-dialog .content").html(f);$("#alert-dialog").dialog({width:450,height:250,title:(g||"提示")});$("#alert-dialog").dialog("open")}if(d){var c=js._TooltipCache[d];if(c){e(c.Subject,c.Body)}else{js.Web.AjaxRequest(null,js.Web.GenerateUrl("SimpleQuery","OnQueryGlobalNotification",d,null,null,null,null,null,null),null,function(j,h){if(j&&h&&h.tag){var g=h.tag,k=g.Id,i=(g.Subject||"提示").trim(),f=g.Body.trim();js._TooltipCache[d]=h.tag;e(i,f);js.StopEvent(event);return}else{if(h&&h.msg){js.Web.ShowMsg(h.msg,"失败",null,null,0);return}}js.Web.ShowMsg("找不到对应的帮助信息",null,null,null,0)},null,null,true,false,true)}}return false})};js.Init.InitPage=function(c){try{if(js.Sys.CheckUserAuthroizationConflict()){var a=js.Web.GenerateUrl("Home","ShowSessionConflictNotice");window.open(a,"_self");return}document.onkeypress=js.Init.DisableBackspace;document.onkeydown=js.Init.DisableBackspace;js.Md5=window.hex_md5;if(js.Browser&&js.Browser.CheckBrowser){$.browser=js.Browser;js.Browser.CheckBrowser()}if(js.Sys.GlobalParams&&js.Sys.GlobalParams.ClientAlertOptions){js.Init.InitClientAlertOptions(js.Sys.GlobalParams.ClientAlertOptions)}var e=window;while(e.parent&&e.parent!=e){e=e.parent}js.Sys.IsHostWindow=(e==window);js.Sys.HostWindow=e;if(e.js&&e.js.Caches){js.Caches=e.js.Caches}js.Init.InitPreInitControls();if(js.Sys.EnableJqueryUI){if($.datepicker){$.datepicker.setDefaults($.datepicker.regional["zh-CN"])}js.Init.RenderTabs();js.Init.InitValidator()}if(jQuery&&jQuery.fn.placeholder){$(":input[placeholder]").placeholder()}var d=document.getElementById("loading-close");if(d){d.onclick=function(){js.Init.CloseLoading()}}$(".eui-panel").each(function(g,i){var k=$(".eui-panel-title .collapseable",i);if(k.length>0){var j=k.hasClass("collapsed");var h=k.hasClass("expand");var f={collapsed:j,collapseable:h||j};$(i).data("options",f);if(f.collapsed){$(".eui-panel-content",i).hide()}}});$(".eui-panel-title").click(function(){var i=this;var f=$(i).find(".collapseable");if(f.length<=0){return}var h=i.parentNode;var g=$(h).data("options");if(!g.collapseable){return}var j=$(".eui-panel-content",h);if(g.collapsed){j.show();f.removeClass("collapsed");f.addClass("expand");js.Init.InitEditFields(false,j)}else{j.hide(200);f.removeClass("expand");f.addClass("collapsed")}g.collapsed=!g.collapsed});js.Init.InitIFrame();js.Init.RegisterPageSizeHandler(js.Init.InitEditFields);$("span.eui-tooltip").click(function(){var f=this,g=$(f),h=g.attr("title");if(h){js.Web.ShowAlertMsg(h,"提示")}});if($.fn&&$.fn.tooltip){$('[data-toggle="tooltip"]').tooltip({html:true,delay:100})}js.Init.ShowRenderTimeCost()}catch(b){js.Web.ShowMsg("页面初始化失败: "+b)}finally{js.UI.HideLoadingMask()}};js.Init.InitIFrame=function(){var a=$("iframe.wrap-content");a.on("unload",function(f){var c=this,g=c,d,b=$(this);b.css("height",null)});a.on("load",function(h){var f=this,j=f,g,c=$(this);try{c.height(200).width(200);g=j.contentWindow.document||j.contentDocument||window.frames[j.id].document;if(g){var i=$(g),b=i.outerHeight(),d=i.outerWidth();c.height(b+40).width(d+40)}}catch(h){}if($.messager.progress){$.messager.progress("close")}})};js.Init.CloseLoading=function(){var a="loading-main";$("#"+a).fadeOut("slow")};if($.fn.datagrid){js.Override($.fn.datagrid.defaults.editors.combobox,{init:function(a,d,e){d.onSelect=function(j,g){var f=$(this);var h=f.data("combobox").options;if(h&&h.relatedTextColumn){var c=h.container,i=f.parents("table").parents("tr");rowIndex=i.attr("datagrid-row-index"),row=c.methods.getRows(c.el)[rowIndex],relatedTextColumnCell=i.find("td[field="+h.relatedTextColumn+"] .datagrid-cell"),selectText=f.combobox("getText");if(selectText){row[h.relatedTextColumn]=selectText;relatedTextColumnCell.text(selectText)}}};var b=$.fn.datagrid.defaults.editors.combobox.override.init(a,d);return b}},true)}js.Controls.ValidateBox=function(b){var a=true;var c={};if(!b){c=$("input.validatebox-invalid")}else{if(js.IsJQuery(b)){c=b.find("input.validatebox-invalid")}else{c=$(b).find("input.validatebox-invalid")}}c.each(function(){if(!$(this).validatebox("isValid")){a=false;$(this).focus();return false}});return a};js.Web.preViewPDF=function(b,a){var e=b||this;var g=window.location.protocol;var d=window.location.host;var f=encodeURIComponent(g+"//"+d+a);var c="../Scripts/generic/web/viewer.html?file="+f;js.Web.OpenWindow(e,c,"_blank","")};